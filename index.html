<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hor√°rio Espiritual</title>

<style>
* { box-sizing: border-box; font-family: Arial, sans-serif; }

body {
  margin: 0;
  background:url("igreja.jpg") center/cover no-repeat fixed;
}

.header {
  background: #fff;
  padding: 12px;
  text-align: center;
  font-weight: bold;
  font-size: 20px;
}

.controls {
  background: #fff;
  margin: 10px;
  padding: 10px;
  border-radius: 8px;
}

.controls select, .controls button {
  width: 100%;
  padding: 10px;
  margin-top: 6px;
  font-size: 16px;
}

.container {
  background: #fff;
  margin: 10px;
  padding: 10px;
  border-radius: 8px;
  overflow-x: auto;
}

table {
  border-collapse: collapse;
  width: max-content;
}

th, td {
  border: 1px solid #ccc;
  padding: 4px;
  text-align: center;
  font-size: 13px;
}

th {
  background: #eee;
}

.categoria {
  background: #ddd;
  font-weight: bold;
  text-align: left;
  padding-left: 8px;
}

.acao-cell {
  min-width: 160px;
}

.acao-input {
  width: 100%;
  border: none;
  font-weight: bold;
  font-size: 14px;
}

.btn {
  cursor: pointer;
  font-weight: bold;
  margin-left: 6px;
}

.btn.add { color: #2f5cff; }
.btn.del { color: #e53935; }

.dia {
  width: 26px;
  height: 26px;
  cursor: pointer;
  background: #f0f0f0;
}

.feito { background: #4CAF50 !important; }
.parcial { background: #FFC107 !important; }
.nao { background: #F44336 !important; }

/* MOBILE */
@media (max-width: 768px) {
  table {
    display: block;
    overflow-x: auto;
    white-space: nowrap;
  }

  th:first-child,
  td:first-child {
    position: sticky;
    left: 0;
    background: #fff;
    z-index: 3;
  }

  .categoria {
    position: sticky;
    left: 0;
    z-index: 4;
  }
}

/* MODAL */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  display: none;
  align-items: center;
  justify-content: center;
}

.modal-box {
  background: #fff;
  padding: 16px;
  border-radius: 10px;
  width: 90%;
  max-width: 320px;
  text-align: center;
}

.modal-box button {
  width: 100%;
  padding: 10px;
  margin-top: 6px;
  font-size: 16px;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="header">HOR√ÅRIO ESPIRITUAL</div>

<div class="controls">
  <select id="pessoa">
    <option>Eduardo</option>
    <option>Alessandra</option>
  </select>

  <select id="mes">
    <option>Janeiro</option><option>Fevereiro</option><option>Mar√ßo</option>
    <option>Abril</option><option>Maio</option><option>Junho</option>
    <option>Julho</option><option>Agosto</option><option>Setembro</option>
    <option>Outubro</option><option>Novembro</option><option>Dezembro</option>
  </select>

  <select id="ano"></select>

  <button onclick="salvar()">üíæ Salvar</button>
</div>

<div class="container">
<table id="tabela">
<thead>
<tr>
  <th>A√á√ÉO</th>
  <script>
    for(let i=1;i<=31;i++) document.write(`<th>${i}</th>`);
  </script>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-box">
    <p>Status do dia</p>
    <button onclick="setStatus('feito')" style="background:#4CAF50;color:#fff">Feito</button>
    <button onclick="setStatus('parcial')" style="background:#FFC107">Parcial</button>
    <button onclick="setStatus('nao')" style="background:#F44336;color:#fff">N√£o conclu√≠do</button>
    <button onclick="setStatus('')">Limpar</button>
  </div>
</div>

<script>
const categorias = [
  "Vincula√ß√£o comigo mesmo",
  "Vincula√ß√£o com Deus",
  "Vincula√ß√£o com os outros",
  "Vincula√ß√£o com o trabalho"
];

const tbody = document.getElementById("tbody");
let celulaAtual = null;

function montarTabela(){
  tbody.innerHTML = "";
  categorias.forEach(cat=>{
    tbody.innerHTML += `
      <tr>
        <td class="categoria" colspan="32">
          ${cat}
          <span class="btn add" onclick="addAcao(this)">+</span>
        </td>
      </tr>
      ${linhaAcao()}
    `;
  });
  aplicarClique();
}

function linhaAcao(){
  let html = `<tr>
    <td class="acao-cell">
      <input class="acao-input" placeholder="Digite a a√ß√£o">
      <span class="btn del" onclick="this.closest('tr').remove()">‚úñ</span>
    </td>`;
  for(let i=1;i<=31;i++) html += `<td class="dia"></td>`;
  return html + "</tr>";
}

function addAcao(btn){
  btn.closest("tr").insertAdjacentHTML("afterend", linhaAcao());
  aplicarClique();
}

function aplicarClique(){
  document.querySelectorAll(".dia").forEach(c=>{
    c.onclick = ()=>{
      celulaAtual = c;
      document.getElementById("modal").style.display = "flex";
    };
  });
}

function setStatus(status){
  celulaAtual.className = "dia " + status;
  document.getElementById("modal").style.display = "none";
}

function salvar(){
  const key = pessoa.value + mes.value + ano.value;
  localStorage.setItem(key, tbody.innerHTML);
  alert("Salvo com sucesso!");
}

function carregar(){
  const key = pessoa.value + mes.value + ano.value;
  const dados = localStorage.getItem(key);
  if(dados){
    tbody.innerHTML = dados;
    aplicarClique();
  } else montarTabela();
}

/* ano */
const anoSel = document.getElementById("ano");
const atual = new Date().getFullYear();
for(let a=atual;a<=atual+5;a++) anoSel.innerHTML += `<option>${a}</option>`;

pessoa.onchange = mes.onchange = ano.onchange = carregar;

montarTabela();
</script>

</body>
</html>
