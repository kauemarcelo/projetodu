<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Hor√°rio Espiritual</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:url("igreja.jpg") center/cover no-repeat fixed;
}

.header{
  background:rgba(255,255,255,0.75);
  padding:10px;
  text-align:center;
  font-size:20px;
  font-weight:bold;
}

.top-controls{
  background:rgba(255,255,255,0.85);
  margin:10px 15px;
  padding:8px;
  border-radius:6px;
  text-align:center;
}

.top-controls select, .top-controls button{
  padding:4px;
  margin:0 5px;
}

.container{
  background:rgba(255,255,255,0.85);
  margin:15px;
  padding:10px;
  border-radius:6px;
  overflow-x:auto;
}

table{
  width:max-content;
  border-collapse:collapse;
}

th,td{
  border:1px solid #999;
  padding:3px;
  font-size:12px;
  text-align:center;
}

th{ background:#eee; }

.categoria{
  background:#ddd;
  font-weight:bold;
  text-align:left;
  padding-left:8px;
}

.acao-input{
  width:90%;
  border:none;
  background:transparent;
  font-weight:bold;
}

.btn{
  cursor:pointer;
  font-weight:bold;
  margin-left:6px;
}

.btn.add{ color:#3b5cff; }
.btn.del{ color:#e53935; }

.dia{
  width:24px;
  height:24px;
  cursor:pointer;
  background:#f0f0f0;
}

.verde{ background:#4CAF50; }
.amarelo{ background:#FFC107; }
.vermelho{ background:#F44336; }

/* modal */
.modal{
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.4);
  display:none;
  align-items:center;
  justify-content:center;
}

.modal-box{
  background:#fff;
  padding:15px;
  border-radius:6px;
  text-align:center;
}

.modal-box button{
  margin:5px;
  padding:6px 10px;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="header">HOR√ÅRIO ESPIRITUAL</div>

<div class="top-controls">
  M√™s:
  <select id="mes">
    <option>Janeiro</option><option>Fevereiro</option><option>Mar√ßo</option>
    <option>Abril</option><option>Maio</option><option>Junho</option>
    <option>Julho</option><option>Agosto</option><option>Setembro</option>
    <option>Outubro</option><option>Novembro</option><option>Dezembro</option>
  </select>

  Ano:
  <select id="ano"></select>

  <button onclick="salvar()">üíæ Salvar</button>
</div>

<div class="container">
<table>

<thead>
<tr>
  <th>A√á√ÉO</th>
  <script>
    for(let i=1;i<=31;i++) document.write("<th>"+i+"</th>");
  </script>
</tr>
</thead>

<tbody>

<script>
const categorias = [
  "Vincula√ß√£o comigo mesmo",
  "Vincula√ß√£o com Deus",
  "Vincula√ß√£o com os outros",
  "Vincula√ß√£o com o trabalho"
];

categorias.forEach(nome=>{
  document.write(`
    <tr>
      <td class="categoria" colspan="32">
        ${nome}
        <span class="btn add" onclick="addAcao(this)">+</span>
      </td>
    </tr>
  `);

  for(let a=0;a<3;a++){
    document.write("<tr class='acao-row'>");
    document.write(`
      <td>
        <input class="acao-input" placeholder="Digite a a√ß√£o do m√™s">
        <span class="btn del" onclick="removeAcao(this)">‚úñ</span>
      </td>
    `);
    for(let i=1;i<=31;i++){
      document.write("<td class='dia'></td>");
    }
    document.write("</tr>");
  }
});
</script>

</tbody>
</table>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-box">
    <p>Escolha o status do dia</p>
    <button onclick="setStatus('verde')" style="background:#4CAF50">Verde</button>
    <button onclick="setStatus('amarelo')" style="background:#FFC107">Amarelo</button>
    <button onclick="setStatus('vermelho')" style="background:#F44336">Vermelho</button>
    <button onclick="setStatus('')">Limpar</button>
  </div>
</div>

<script>
let celulaAtual = null;

/* ---------- ANO ---------- */
const anoSel = document.getElementById("ano");
const anoAtual = new Date().getFullYear();

for(let a=anoAtual; a<=anoAtual+5; a++){
  anoSel.innerHTML += `<option>${a}</option>`;
}


/* ---------- ATIVAR CLIQUE ---------- */
function ativarDias(contexto=document){
  contexto.querySelectorAll(".dia").forEach(c=>{
    c.onclick = ()=>{
      celulaAtual = c;
      document.getElementById("modal").style.display="flex";
    };
  });
}
ativarDias();

/* ---------- STATUS ---------- */
function setStatus(status){
  if(!celulaAtual) return;
  celulaAtual.className = "dia " + status;
  document.getElementById("modal").style.display="none";
}

/* ---------- A√á√ïES ---------- */
function addAcao(btn){
  const cat = btn.closest("tr");
  const nova = document.createElement("tr");
  nova.className = "acao-row";

  let html = `
    <td>
      <input class="acao-input" placeholder="Digite a a√ß√£o do m√™s">
      <span class="btn del" onclick="removeAcao(this)">‚úñ</span>
    </td>
  `;
  for(let i=1;i<=31;i++) html += `<td class="dia"></td>`;
  nova.innerHTML = html;

  cat.after(nova);
  ativarDias(nova);
}

function removeAcao(btn){
  btn.closest("tr").remove();
}

/* ---------- SALVAR ---------- */
function salvar(){
  const dados = {
    mes: document.getElementById("mes").value,
    ano: document.getElementById("ano").value,
    acoes: []
  };

  document.querySelectorAll(".acao-row").forEach(row=>{
    const acao = row.querySelector(".acao-input").value;
    const dias = [];

    row.querySelectorAll(".dia").forEach(d=>{
      dias.push(
        d.classList.contains("verde") ? "verde" :
        d.classList.contains("amarelo") ? "amarelo" :
        d.classList.contains("vermelho") ? "vermelho" : ""
      );
    });

    dados.acoes.push({acao, dias});
  });

  const chave = `horario_${dados.mes}_${dados.ano}`;
  localStorage.setItem(chave, JSON.stringify(dados));

  alert("Hor√°rio espiritual salvo com sucesso üôè");
}

/* ---------- CARREGAR ---------- */
function carregar(){
  const mes = document.getElementById("mes").value;
  const ano = document.getElementById("ano").value;
  const chave = `horario_${mes}_${ano}`;

  const salvo = localStorage.getItem(chave);
  if(!salvo) return;

  const dados = JSON.parse(salvo);

  const rows = document.querySelectorAll(".acao-row");
  dados.acoes.forEach((item,i)=>{
    if(!rows[i]) return;

    rows[i].querySelector(".acao-input").value = item.acao;
    rows[i].querySelectorAll(".dia").forEach((d,idx)=>{
      d.className = "dia " + (item.dias[idx] || "");
    });
  });
}

/* ---------- EVENTOS ---------- */
document.getElementById("mes").onchange = carregar;
document.getElementById("ano").onchange = carregar;

window.onload = carregar;
</script>


</body>
</html>
